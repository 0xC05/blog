{"componentChunkName":"component---src-templates-page-js","path":"/vba-macro-obfuscator-analysis","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Digging a Hole Through Obfuscated VBA Malware","date":"07 July 2020","path":"/vba-macro-obfuscator-analysis","author":"SYN","excerpt":null,"tags":null,"coverImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEAklEQVQ4y32U60+TZxTA+68s8YPJZmZcsi9LppvLnNtQg4ojmomK9w0FQancBpMBKlUKik7BG1QFCkKkXMelwKQtnUIpymDdZim3lpZC7YWW/vb0RcO3neTk5Hnec3455z3nObLx8TH0ej06XT8GwwAjI2Zx1jE0ZBI6RH9/v/S9X6djeHgYo3GA3r7f0XZ3S36Dwq+rq4vA0hIRkUUAWm2PFGgwGESAkfa2VrpFgLanB52AdXZ2SkE9Wi3WCRtenw+nw47b7SYQWMLhcBAKhVaAbzwe7HY7s7OzOJ1O5ubmmJ6aZHLSxsz0tHS22Sawz85gtVrxehb4P5FNTExIju9E9XyajKej3DdOktn6D8lqExfbRklUv+S8+jmJD/pJKa7gZ8V1svIVXMjMQC5PZ1tiIcqHjcjGxsawWCxvcWGKtK/5vETHiZoRElqsfHHbzD7VC/ZWmom+/ozYir+IK6mmKn4t2aflbM6rJyFmI+99upfD+WXIPKLkiAbf/oP0plesKehj+80OEh40sbOwgd0lHcRXmfnsci9Hb7UTe6me0szvKTx5hNiiVtJOx/Ht9lhOlaiReb1eCbi0FJSA+X2v+URkcaHpCaNPttF44AN0N7LIHfYS/WiSiko5moPruKR8SFS5idwfd3D2yFHW7M0mvUCBLBgMik4FCC0vSyWrBmc412EjsWWYaf1+BvPWYzm7hUrTFBlDcLWhFmvOWhqzUjlUN8Uv2adQHtjKhsMK0q7cRBYKBYlA37W91DjDiVYLMTVmimuuUlWZRr78J+T3NWTeVpGWlcvDvD2Uxe/kcLmeb/Ib2JNzj/fjFZy5VotscXFRmiOfzysBn/WWc/zQVnpTv6ZY1UzeWJgd7UGudmkYLd3A4JGPGVftxnxsLbfuaYipGCdG2cm6Y8WklqpXSvb7fYSEjRS9YLpMbcpHWJI/xKBMp8rmp8i8iLx1lD/U36FP2ogmZx+Pz0cjT8khLjmHHw7tY/OWKOQ36pCtjmRYAtr0CjSlUbSnf8lvKfEkNv+LvPM1m268JL3kIsrEXRQlnWHnvVdEK2rpLk0WTcvgTmYSBb9WIwuHw0SU8DKRPl9Tq8goTGZ/8lmyjp/kYFEz0TUW1ivHSLhdzt3UTRTs+oq4K41szm3iyl0VD+485kL2Nc4pylYylICRDIVpG7FiGtKiqa/G0vII/YCJtr8XqH7h4KnxTwzPGumoU9PQ+ZyyFiP3W3RUdA1x82kfHQMjq0CJKaABjxuX08Wi5w1Oj5f5eReu2SncjmkWnA7RQBduMbcL804WXQ7euF3i3r76llczXAHOiQURWRaRzs+JjWIX1jXvxie2is/vJyDUL9QnaQC/mGHpXjyMZVHif1vuAasb4FVdAAAAAElFTkSuQmCC","aspectRatio":1.2422360248447204,"src":"/static/7cc673619e2f9a990af3069922b2efd2/ee604/vba-macro-obfuscator-analysis-article.png","srcSet":"/static/7cc673619e2f9a990af3069922b2efd2/69585/vba-macro-obfuscator-analysis-article.png 200w,\n/static/7cc673619e2f9a990af3069922b2efd2/497c6/vba-macro-obfuscator-analysis-article.png 400w,\n/static/7cc673619e2f9a990af3069922b2efd2/ee604/vba-macro-obfuscator-analysis-article.png 800w,\n/static/7cc673619e2f9a990af3069922b2efd2/efc77/vba-macro-obfuscator-analysis-article.png 865w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"id":"9d0864aa-0c1a-520c-9ec6-6c2907a69046","html":"<hr>\n<p>Hello there! How are you doing this fine day? Welcome to my blog post about a fascinating tool which can make your computer’s life hell if you’re not careful enough :P</p>\n<p>Macro Malware are very common in the threat world, and it has been in use since Macros were introduced in various applications. The most common type of Macro Malwares is seen in Visual Basic as, Microsoft Introduced Visual Basic for Applications (commonly known as VBA) in their Office product line so users can automate a lot of their day to day work while dealing with office productivity.</p>\n<p>Due to some function calls present in VBA, which can easily be used to download a payload from the internet and infect someone’s computer, this has resulted into VBA Macros to be weaponized due to this and little did we know, this thing will be the most used malware in Phishing Campaigns done by APTs all around the world.</p>\n<hr>\n<p>Introducing <a href=\"https://github.com/bonnetn/vba-obfuscator\">vba-obfuscator</a>, a tool which obfuscates VBA macros in a simple, yet very effective way. This tool was made by <a href=\"https://github.com/bonnetn/\">bonnetn</a> (Github) as a 2018 School Project.\nVery neat python tool which takes a VBA script and obfuscates it with multiple methods involved. Here is a sample payload delivery macro malware obfuscated with this obfuscator.</p>\n<p>Except for the <code class=\"language-text\">Auto_Open</code> subs, you can’t figure out what is going on because the function names and variable names have been obfuscated with what seems to be Base64. But if you try decoding a Base64 variable name, it returns random characters which again doesn’t make any sense.</p>\n<hr>\n<h4>Now let’s look at the VirusTotal Detection of this file:-</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5638675dd95710f1a5e1ac6df6a77798/26530/vba-macro-obfuscator-analysis-vt.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABEUlEQVQoz41TDW+DIBDl///HZdlMP2alIohRwLvxuHXt1NppLiZ4PN7HoWJMjIeItgv/jGP6PDF9HJnODVOIm70hBFbTNHFK6TkgyvZMX1pKmwwYZH3+2zeOIytrLc/z/BoQzA4106VlajumKQj7hz6QU8Mw/EOyFbmQ/X5galqxoR/WgF1mGGPcB+ycAFZnKcjGIV3/24enAGqt2Xv/nCVebKyvAoQvwIqH85ohwHb9u3l4uuRQso/HWhhD1YJECcUYw865Evkmy5uH8A9y36rMMqcd0/bYIOWXoYBR9QOItK9G5C72YfwU2EE26O6Pjb7PYmtlrfdrQIxNyqftzqLPm5vMLttTgMAYl2FxIQD4DX20X6sJDteFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vba macro obfuscator analysis vt\"\n        title=\"vba macro obfuscator analysis vt\"\n        src=\"/static/5638675dd95710f1a5e1ac6df6a77798/78d47/vba-macro-obfuscator-analysis-vt.png\"\n        srcset=\"/static/5638675dd95710f1a5e1ac6df6a77798/56d15/vba-macro-obfuscator-analysis-vt.png 200w,\n/static/5638675dd95710f1a5e1ac6df6a77798/d9f49/vba-macro-obfuscator-analysis-vt.png 400w,\n/static/5638675dd95710f1a5e1ac6df6a77798/78d47/vba-macro-obfuscator-analysis-vt.png 800w,\n/static/5638675dd95710f1a5e1ac6df6a77798/26530/vba-macro-obfuscator-analysis-vt.png 944w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This sample file’s detection has increased from 8 to 19 over all. But if we take a harmless obfuscated file which prints Hello World, it gives us 5 detections.\nWhile 19 detections (at the time of writing) is still good, but let’s see what Inquest Labs has to say about our sample file:-</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7eb2530d6c60eee251e9da7792f46c28/4ceeb/vba-macro-obfuscator-analysis-inquest.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.000000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAo0lEQVQY022QgQ7DIAhE/f9vrYgourW22wFpsmV7wXpa1IPEzES073trQ0QREBHSsOzHsc4fLiep6pyztcZcaxWRZlHtWw0ZYw6MiTAejotnQn4VJHG9wQWx9Bu5946nXv9IyOiOz6q3hiPt6tp+oC5kw+rX4ZxzoUIWRJkKuyBiLgH0tm0Q2IAf1ADb4cVqDvzdYPQPUPB1WZOib2utaBgOvwEi5lnnIL0HTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vba macro obfuscator analysis inquest\"\n        title=\"vba macro obfuscator analysis inquest\"\n        src=\"/static/7eb2530d6c60eee251e9da7792f46c28/78d47/vba-macro-obfuscator-analysis-inquest.png\"\n        srcset=\"/static/7eb2530d6c60eee251e9da7792f46c28/56d15/vba-macro-obfuscator-analysis-inquest.png 200w,\n/static/7eb2530d6c60eee251e9da7792f46c28/d9f49/vba-macro-obfuscator-analysis-inquest.png 400w,\n/static/7eb2530d6c60eee251e9da7792f46c28/78d47/vba-macro-obfuscator-analysis-inquest.png 800w,\n/static/7eb2530d6c60eee251e9da7792f46c28/4ceeb/vba-macro-obfuscator-analysis-inquest.png 1073w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>If we read the comment, we see that most of the malicious traits and suspicions are based on the obfuscation. Not what the file does to the system. So now, what do we do? Well we figure out what the obfuscated code does!</p>\n<hr>\n<h3>DISCLAIMER: I am doing everything here for research purposes, this program is meant for research purposes and neither me or bonnetn are responsible for your actions. For the research, I take a sample Hello World VBA Macro and obfuscated it using the tool.</h3>\n<hr>\n<p><strong>Sample Code:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Sub</span> HelloWorld<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nMsgBox <span class=\"token string\">\"Hello World\"</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span></code></pre></div>\n<p><strong>Obfuscated Code:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\">DQdqmDHFAZsXlO       <span class=\"token keyword\">As</span> <span class=\"token keyword\">Boolean</span>\n<span class=\"token keyword\">Private</span> phLmzjBheZF<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">58</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Private</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">51</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">76</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Sub</span> nzOxchBVlT<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nMsgBox hhWpOZVspDmEP<span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">41</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">89</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> hhWpOZVspDmEP<span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">134</span><span class=\"token operator\">+</span><span class=\"token number\">57</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">133</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">162</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">213</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">61</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">122</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">29</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token operator\">+</span><span class=\"token number\">134</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">237</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span>\n<span class=\"token keyword\">Public</span> <span class=\"token keyword\">Function</span> KWcnPHwXPA<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> WyGwDJjQmpPM <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> <span class=\"token keyword\">Not</span> DQdqmDHFAZsXlO <span class=\"token keyword\">Then</span> VjSimTuxaHK\n<span class=\"token keyword\">Dim</span> YusDIhkwWF<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> YusDIhkwWF <span class=\"token operator\">=</span> jIuArLmtySP<span class=\"token punctuation\">(</span>WyGwDJjQmpPM<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> eqmzXFGApJxQ <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> eqmzXFGApJxQ <span class=\"token operator\">=</span> UBound<span class=\"token punctuation\">(</span>YusDIhkwWF<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> eqmzXFGApJxQ <span class=\"token keyword\">Mod</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">Then</span> Err<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> eqmzXFGApJxQ <span class=\"token operator\">></span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">If</span> YusDIhkwWF<span class=\"token punctuation\">(</span>eqmzXFGApJxQ <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Do</span>\neqmzXFGApJxQ <span class=\"token operator\">=</span> eqmzXFGApJxQ <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Loop</span>\n<span class=\"token keyword\">Dim</span> OqhxSKRyhLn <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> OqhxSKRyhLn <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>eqmzXFGApJxQ <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">ReDim</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> OqhxSKRyhLn <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Dim</span> EtCjywfjssUWc <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">Dim</span> XjDMeszHGiIFe <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ\n<span class=\"token keyword\">Dim</span> tkPecfFdocqqBt <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> tkPecfFdocqqBt <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> CAWpFwggkrrZh <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> CAWpFwggkrrZh <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Dim</span> ujzMwVqMml <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ <span class=\"token keyword\">Then</span> ujzMwVqMml <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token keyword\">Else</span> ujzMwVqMml <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> QVokeaazcWcAqh <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ <span class=\"token keyword\">Then</span> QVokeaazcWcAqh <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Else</span> QVokeaazcWcAqh <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> tkPecfFdocqqBt <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> CAWpFwggkrrZh <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">85</span><span class=\"token operator\">+</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> ujzMwVqMml <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Or</span> QVokeaazcWcAqh <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\nErr<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Dim</span> mhKBvnFFuztlFT <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> mhKBvnFFuztlFT <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>tkPecfFdocqqBt<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> WAGoWUDaPZsf <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> WAGoWUDaPZsf <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>CAWpFwggkrrZh<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> CdOASRvZYFf <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> CdOASRvZYFf <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>ujzMwVqMml<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> uvMHorqBPp <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> uvMHorqBPp <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>QVokeaazcWcAqh<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> mhKBvnFFuztlFT <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> WAGoWUDaPZsf <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">28</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> CdOASRvZYFf <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> uvMHorqBPp <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">43</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\nErr<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Dim</span> lTiZJdRtkLB <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> lTiZJdRtkLB <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>mhKBvnFFuztlFT <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>WAGoWUDaPZsf <span class=\"token operator\">\\</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> ySWAPIOelVOo <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> ySWAPIOelVOo <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>WAGoWUDaPZsf <span class=\"token keyword\">And</span> <span class=\"token number\">&amp;HF</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>CdOASRvZYFf <span class=\"token operator\">\\</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> DtzSAaMlHrPSN <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> DtzSAaMlHrPSN <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>CdOASRvZYFf <span class=\"token keyword\">And</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H40</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> uvMHorqBPp\nMTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lTiZJdRtkLB<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> XjDMeszHGiIFe <span class=\"token operator\">&lt;</span> OqhxSKRyhLn <span class=\"token keyword\">Then</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> ySWAPIOelVOo<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> XjDMeszHGiIFe <span class=\"token operator\">&lt;</span> OqhxSKRyhLn <span class=\"token keyword\">Then</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> DtzSAaMlHrPSN<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Loop</span>\nKWcnPHwXPA <span class=\"token operator\">=</span> MTtJcOcfrKhv\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span>\n<span class=\"token keyword\">Private</span> <span class=\"token keyword\">Sub</span> VjSimTuxaHK<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> OIMIqegisYd <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">,</span> HYiTBTPmizHm <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span>\nHYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"9\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\nphLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nphLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">127</span><span class=\"token punctuation\">:</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">147</span><span class=\"token operator\">+</span><span class=\"token number\">108</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">61</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> HYiTBTPmizHm<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\nDQdqmDHFAZsXlO <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span>\n<span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> jIuArLmtySP<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> WyGwDJjQmpPM <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> WAGoWUDaPZsf <span class=\"token operator\">=</span> WyGwDJjQmpPM\n<span class=\"token keyword\">Dim</span> ohnKHLnEngC <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> ohnKHLnEngC <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>UBound<span class=\"token punctuation\">(</span>WAGoWUDaPZsf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> ohnKHLnEngC <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> jIuArLmtySP <span class=\"token operator\">=</span> WAGoWUDaPZsf<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Function</span>\n<span class=\"token keyword\">Dim</span> CdOASRvZYFf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">ReDim</span> CdOASRvZYFf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> ohnKHLnEngC <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Dim</span> pulOTurWsADzsz <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">For</span> pulOTurWsADzsz <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> ohnKHLnEngC <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Dim</span> OIMIqegisYd <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> OIMIqegisYd <span class=\"token operator\">=</span> WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> pulOTurWsADzsz<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">77</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">333</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">CLng</span><span class=\"token punctuation\">(</span>WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> pulOTurWsADzsz <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> OIMIqegisYd <span class=\"token operator\">></span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">221</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">19</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span>\nCdOASRvZYFf<span class=\"token punctuation\">(</span>pulOTurWsADzsz<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd\n<span class=\"token keyword\">Next</span>\njIuArLmtySP <span class=\"token operator\">=</span> CdOASRvZYFf\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span>\n<span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> hhWpOZVspDmEP<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp <span class=\"token keyword\">As</span> <span class=\"token keyword\">Variant</span><span class=\"token punctuation\">,</span> NcuNirXMUBbUcq <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> nMFesEttTo <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span>\n<span class=\"token keyword\">Dim</span> PwFVZbOlxLL<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\nPwFVZbOlxLL <span class=\"token operator\">=</span> KWcnPHwXPA<span class=\"token punctuation\">(</span>ActiveDocument<span class=\"token punctuation\">.</span>Variables<span class=\"token punctuation\">(</span><span class=\"token string\">\"IbcdbFKknevSZBHt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nnMFesEttTo <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> LBound<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp<span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> UBound<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp<span class=\"token punctuation\">)</span>\nnMFesEttTo <span class=\"token operator\">=</span> nMFesEttTo <span class=\"token operator\">&amp;</span> Chr<span class=\"token punctuation\">(</span>PwFVZbOlxLL<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token operator\">+</span>NcuNirXMUBbUcq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">Xor</span> oTMVKlBiyrDCp<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Next</span>\nhhWpOZVspDmEP <span class=\"token operator\">=</span> nMFesEttTo\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<hr>\n<p>The obfuscated code is what you will find inside the Macro Document which I chose to be the sample.</p>\n<p>Now running the sample macro document in any.app.run, I saw that the document made no API calls on the internet, so we can conclude that the script’s deobfuscation is self reliant, so all of the deobfuscation code will be present in the tool itself.</p>\n<p>I have scoured through the code, and I have compared every obfuscated function and a sub with the non-obfuscated counterpart so it can be extremely clear as to what the script does.</p>\n<p><strong>Obfuscated Variables:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> DQdqmDHFAZsXlO       <span class=\"token keyword\">As</span> <span class=\"token keyword\">Boolean</span>\n<span class=\"token keyword\">Private</span> phLmzjBheZF<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">5</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">58</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Private</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">51</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">76</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span></code></pre></div>\n<p><strong>Deobfuscated Variables:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> InitDone       <span class=\"token keyword\">As</span> <span class=\"token keyword\">Boolean</span>\n<span class=\"token keyword\">Private</span> Map1<span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Private</span> Map2<span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">127</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span></code></pre></div>\n<p>The <code class=\"language-text\">DQdqmDHFAZsXlO/InitDone</code> variable checks if Private Sub <code class=\"language-text\">VjSimTuxaHK/Init</code> has been called or not by the function <code class=\"language-text\">KWcnPHwXPA/Base64Decode</code>.</p>\n<p>The <code class=\"language-text\">phLmzjBheZF/Map1</code> variable is needed for the Private Sub <code class=\"language-text\">VjSimTuxaHK/Init</code>.</p>\n<p>The <code class=\"language-text\">QKJZqUIcJuC/Map2</code> variable is needed for the <code class=\"language-text\">KWcnPHwXPA/Base64Decode</code> function.</p>\n<hr>\n<p><strong>Main VBA Sub:- (Calls the Deobfuscation Functions)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Sub</span> nzOxchBVlT<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nMsgBox hhWpOZVspDmEP<span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">36</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">190</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">41</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">89</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">131</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> hhWpOZVspDmEP<span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">134</span><span class=\"token operator\">+</span><span class=\"token number\">57</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">133</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">162</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">213</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">61</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">122</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">29</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token operator\">+</span><span class=\"token number\">134</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">237</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span></code></pre></div>\n<p><strong>Sub calls the function <em><code class=\"language-text\">hhWpOZVspDmEP/unxor</code></em> to deobfuscate:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> hhWpOZVspDmEP<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp <span class=\"token keyword\">As</span> <span class=\"token keyword\">Variant</span><span class=\"token punctuation\">,</span> NcuNirXMUBbUcq <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> nMFesEttTo <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span>\n<span class=\"token keyword\">Dim</span> PwFVZbOlxLL<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\nPwFVZbOlxLL <span class=\"token operator\">=</span> KWcnPHwXPA<span class=\"token punctuation\">(</span>ActiveDocument<span class=\"token punctuation\">.</span>Variables<span class=\"token punctuation\">(</span><span class=\"token string\">\"IbcdbFKknevSZBHt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nnMFesEttTo <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> LBound<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp<span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> UBound<span class=\"token punctuation\">(</span>oTMVKlBiyrDCp<span class=\"token punctuation\">)</span>\nnMFesEttTo <span class=\"token operator\">=</span> nMFesEttTo <span class=\"token operator\">&amp;</span> Chr<span class=\"token punctuation\">(</span>PwFVZbOlxLL<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token operator\">+</span>NcuNirXMUBbUcq<span class=\"token punctuation\">)</span> <span class=\"token keyword\">Xor</span> oTMVKlBiyrDCp<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Next</span>\nhhWpOZVspDmEP <span class=\"token operator\">=</span> nMFesEttTo\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p><strong>Deobfuscated Function:- (vba-obfuscator/obfuscator/modifier/strings/crypt.py)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> unxor<span class=\"token punctuation\">(</span>ciphertext <span class=\"token keyword\">As</span> <span class=\"token keyword\">Variant</span><span class=\"token punctuation\">,</span> start <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">Dim</span> cleartext <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span>\n    <span class=\"token keyword\">Dim</span> key<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n    key <span class=\"token operator\">=</span> Base64Decode<span class=\"token punctuation\">(</span>ActiveDocument<span class=\"token punctuation\">.</span>Variables<span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cleartext <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n    \n    <span class=\"token keyword\">For</span> i <span class=\"token operator\">=</span> LBound<span class=\"token punctuation\">(</span>ciphertext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> UBound<span class=\"token punctuation\">(</span>ciphertext<span class=\"token punctuation\">)</span>\n        cleartext <span class=\"token operator\">=</span> cleartext <span class=\"token operator\">&amp;</span> Chr<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>start<span class=\"token punctuation\">)</span> <span class=\"token keyword\">Xor</span> ciphertext<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">Next</span>\n    unxor <span class=\"token operator\">=</span> cleartext\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p><strong><em><code class=\"language-text\">hhWpOZVspDmEP/unxor</code></em> calls function <em><code class=\"language-text\">KWcnPHwXPA/Base64Decode</code></em>:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Public</span> <span class=\"token keyword\">Function</span> KWcnPHwXPA<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> WyGwDJjQmpPM <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> <span class=\"token keyword\">Not</span> DQdqmDHFAZsXlO <span class=\"token keyword\">Then</span> VjSimTuxaHK\n<span class=\"token keyword\">Dim</span> YusDIhkwWF<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> YusDIhkwWF <span class=\"token operator\">=</span> jIuArLmtySP<span class=\"token punctuation\">(</span>WyGwDJjQmpPM<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> eqmzXFGApJxQ <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> eqmzXFGApJxQ <span class=\"token operator\">=</span> UBound<span class=\"token punctuation\">(</span>YusDIhkwWF<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> eqmzXFGApJxQ <span class=\"token keyword\">Mod</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">Then</span> Err<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> eqmzXFGApJxQ <span class=\"token operator\">></span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">If</span> YusDIhkwWF<span class=\"token punctuation\">(</span>eqmzXFGApJxQ <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Do</span>\neqmzXFGApJxQ <span class=\"token operator\">=</span> eqmzXFGApJxQ <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Loop</span>\n<span class=\"token keyword\">Dim</span> OqhxSKRyhLn <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> OqhxSKRyhLn <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>eqmzXFGApJxQ <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">ReDim</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> OqhxSKRyhLn <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Dim</span> EtCjywfjssUWc <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">Dim</span> XjDMeszHGiIFe <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ\n<span class=\"token keyword\">Dim</span> tkPecfFdocqqBt <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> tkPecfFdocqqBt <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> CAWpFwggkrrZh <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> CAWpFwggkrrZh <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Dim</span> ujzMwVqMml <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ <span class=\"token keyword\">Then</span> ujzMwVqMml <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token keyword\">Else</span> ujzMwVqMml <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> QVokeaazcWcAqh <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> EtCjywfjssUWc <span class=\"token operator\">&lt;</span> eqmzXFGApJxQ <span class=\"token keyword\">Then</span> QVokeaazcWcAqh <span class=\"token operator\">=</span> YusDIhkwWF<span class=\"token punctuation\">(</span>EtCjywfjssUWc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> EtCjywfjssUWc <span class=\"token operator\">=</span> EtCjywfjssUWc <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Else</span> QVokeaazcWcAqh <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> tkPecfFdocqqBt <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> CAWpFwggkrrZh <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">85</span><span class=\"token operator\">+</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> ujzMwVqMml <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Or</span> QVokeaazcWcAqh <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\nErr<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Dim</span> mhKBvnFFuztlFT <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> mhKBvnFFuztlFT <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>tkPecfFdocqqBt<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> WAGoWUDaPZsf <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> WAGoWUDaPZsf <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>CAWpFwggkrrZh<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> CdOASRvZYFf <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> CdOASRvZYFf <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>ujzMwVqMml<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> uvMHorqBPp <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> uvMHorqBPp <span class=\"token operator\">=</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>QVokeaazcWcAqh<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> mhKBvnFFuztlFT <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> WAGoWUDaPZsf <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">28</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> CdOASRvZYFf <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> uvMHorqBPp <span class=\"token operator\">></span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">43</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\nErr<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n<span class=\"token keyword\">Dim</span> lTiZJdRtkLB <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> lTiZJdRtkLB <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>mhKBvnFFuztlFT <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>WAGoWUDaPZsf <span class=\"token operator\">\\</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> ySWAPIOelVOo <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> ySWAPIOelVOo <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>WAGoWUDaPZsf <span class=\"token keyword\">And</span> <span class=\"token number\">&amp;HF</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>CdOASRvZYFf <span class=\"token operator\">\\</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> DtzSAaMlHrPSN <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> DtzSAaMlHrPSN <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>CdOASRvZYFf <span class=\"token keyword\">And</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H40</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> uvMHorqBPp\nMTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> lTiZJdRtkLB<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> XjDMeszHGiIFe <span class=\"token operator\">&lt;</span> OqhxSKRyhLn <span class=\"token keyword\">Then</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> ySWAPIOelVOo<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> XjDMeszHGiIFe <span class=\"token operator\">&lt;</span> OqhxSKRyhLn <span class=\"token keyword\">Then</span> MTtJcOcfrKhv<span class=\"token punctuation\">(</span>XjDMeszHGiIFe<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> DtzSAaMlHrPSN<span class=\"token punctuation\">:</span> XjDMeszHGiIFe <span class=\"token operator\">=</span> XjDMeszHGiIFe <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Loop</span>\nKWcnPHwXPA <span class=\"token operator\">=</span> MTtJcOcfrKhv\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p><strong>Deobfuscated Function:- (vba-obfuscator/obfuscator/modifier/strings/base64.vbs)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Public</span> <span class=\"token keyword\">Function</span> Base64Decode<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> s <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">If</span> <span class=\"token keyword\">Not</span> InitDone <span class=\"token keyword\">Then</span> Init\n   <span class=\"token keyword\">Dim</span> IBuf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> IBuf <span class=\"token operator\">=</span> ConvertStringToBytes<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">Dim</span> ILen <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> ILen <span class=\"token operator\">=</span> UBound<span class=\"token punctuation\">(</span>IBuf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n   <span class=\"token comment\">' If ILen Mod 4 &lt;> 0 Then Err.Raise vbObjectError, , \"Length of Base64 encoded input string is not a multiple of 4.\"</span>\n   <span class=\"token keyword\">If</span> ILen <span class=\"token keyword\">Mod</span> <span class=\"token number\">4</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token keyword\">Then</span> Err<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n   <span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> ILen <span class=\"token operator\">></span> <span class=\"token number\">0</span>\n      <span class=\"token keyword\">If</span> IBuf<span class=\"token punctuation\">(</span>ILen <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Do</span>\n      ILen <span class=\"token operator\">=</span> ILen <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">Loop</span>\n   <span class=\"token keyword\">Dim</span> OLen <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> OLen <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>ILen <span class=\"token operator\">*</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token number\">4</span>\n   <span class=\"token keyword\">Dim</span> <span class=\"token keyword\">Out</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n   <span class=\"token keyword\">ReDim</span> <span class=\"token keyword\">Out</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">To</span> OLen <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n   <span class=\"token keyword\">Dim</span> ip <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n   <span class=\"token keyword\">Dim</span> op <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n   <span class=\"token keyword\">Do</span> <span class=\"token keyword\">While</span> ip <span class=\"token operator\">&lt;</span> ILen\n      <span class=\"token keyword\">Dim</span> i0 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> i0 <span class=\"token operator\">=</span> IBuf<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> ip <span class=\"token operator\">=</span> ip <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">Dim</span> i1 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> i1 <span class=\"token operator\">=</span> IBuf<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> ip <span class=\"token operator\">=</span> ip <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">Dim</span> i2 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> ip <span class=\"token operator\">&lt;</span> ILen <span class=\"token keyword\">Then</span> i2 <span class=\"token operator\">=</span> IBuf<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> ip <span class=\"token operator\">=</span> ip <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token keyword\">Else</span> i2 <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> i3 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">If</span> ip <span class=\"token operator\">&lt;</span> ILen <span class=\"token keyword\">Then</span> i3 <span class=\"token operator\">=</span> IBuf<span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> ip <span class=\"token operator\">=</span> ip <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token keyword\">Else</span> i3 <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">If</span> i0 <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Or</span> i1 <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Or</span> i2 <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Or</span> i3 <span class=\"token operator\">></span> <span class=\"token number\">127</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\n         <span class=\"token comment\">' Err.Raise vbObjectError, , \"Illegal character in Base64 encoded data.\"</span>\n         Err<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token keyword\">Dim</span> b0 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> b0 <span class=\"token operator\">=</span> Map2<span class=\"token punctuation\">(</span>i0<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> b1 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> b1 <span class=\"token operator\">=</span> Map2<span class=\"token punctuation\">(</span>i1<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> b2 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> b2 <span class=\"token operator\">=</span> Map2<span class=\"token punctuation\">(</span>i2<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> b3 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> b3 <span class=\"token operator\">=</span> Map2<span class=\"token punctuation\">(</span>i3<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">If</span> b0 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token keyword\">Or</span> b1 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token keyword\">Or</span> b2 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token keyword\">Or</span> b3 <span class=\"token operator\">></span> <span class=\"token number\">63</span> <span class=\"token keyword\">Then</span> <span class=\"token operator\">_</span>\n         <span class=\"token comment\">' Err.Raise vbObjectError, , \"Illegal character in Base64 encoded data.\"</span>\n         Err<span class=\"token punctuation\">.</span>Raise vbObjectError<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token keyword\">Dim</span> o0 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> o0 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>b0 <span class=\"token operator\">*</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>b1 <span class=\"token operator\">\\</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> o1 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> o1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>b1 <span class=\"token keyword\">And</span> <span class=\"token number\">&amp;HF</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H10</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> <span class=\"token punctuation\">(</span>b2 <span class=\"token operator\">\\</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">Dim</span> o2 <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> o2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>b2 <span class=\"token keyword\">And</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">&amp;H40</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Or</span> b3\n      <span class=\"token keyword\">Out</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> o0<span class=\"token punctuation\">:</span> op <span class=\"token operator\">=</span> op <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">If</span> op <span class=\"token operator\">&lt;</span> OLen <span class=\"token keyword\">Then</span> <span class=\"token keyword\">Out</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> o1<span class=\"token punctuation\">:</span> op <span class=\"token operator\">=</span> op <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">If</span> op <span class=\"token operator\">&lt;</span> OLen <span class=\"token keyword\">Then</span> <span class=\"token keyword\">Out</span><span class=\"token punctuation\">(</span>op<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> o2<span class=\"token punctuation\">:</span> op <span class=\"token operator\">=</span> op <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">Loop</span>\n   Base64Decode <span class=\"token operator\">=</span> <span class=\"token keyword\">Out</span>\n   <span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p>The code checks if the Boolean <code class=\"language-text\">DQdqmDHFAZsXlO/InitDone</code> is TRUE. If not TRUE then it calls Private Sub <code class=\"language-text\">VjSimTuxaHK/Init</code>.</p>\n<p><strong><em><code class=\"language-text\">KWcnPHwXPA/Base64Decode</code></em> calls private sub <em><code class=\"language-text\">VjSimTuxaHK/Init</code></em>:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Sub</span> VjSimTuxaHK<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> OIMIqegisYd <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">,</span> HYiTBTPmizHm <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span>\nHYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"9\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd<span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\nphLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nphLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> HYiTBTPmizHm <span class=\"token operator\">=</span> HYiTBTPmizHm <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">127</span><span class=\"token punctuation\">:</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">147</span><span class=\"token operator\">+</span><span class=\"token number\">108</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n<span class=\"token keyword\">For</span> HYiTBTPmizHm <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> <span class=\"token punctuation\">(</span><span class=\"token number\">61</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> QKJZqUIcJuC<span class=\"token punctuation\">(</span>phLmzjBheZF<span class=\"token punctuation\">(</span>HYiTBTPmizHm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> HYiTBTPmizHm<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\nDQdqmDHFAZsXlO <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span></code></pre></div>\n<p><strong>Deobfuscated Private Sub:- (vba-obfuscator/obfuscator/modifier/strings/base64.vbs)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Sub</span> Init<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">Dim</span> c <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span><span class=\"token punctuation\">,</span> i <span class=\"token keyword\">As</span> <span class=\"token keyword\">Integer</span>\n   <span class=\"token comment\">' set Map1</span>\n   i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n   <span class=\"token keyword\">For</span> c <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">:</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n   <span class=\"token keyword\">For</span> c <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"z\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">:</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n   <span class=\"token keyword\">For</span> c <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"9\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">:</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n   Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n   Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> i <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n   <span class=\"token comment\">' set Map2</span>\n   <span class=\"token keyword\">For</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">127</span><span class=\"token punctuation\">:</span> Map2<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">255</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n   <span class=\"token keyword\">For</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">To</span> <span class=\"token number\">63</span><span class=\"token punctuation\">:</span> Map2<span class=\"token punctuation\">(</span>Map1<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> i<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Next</span>\n   InitDone <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n   <span class=\"token keyword\">End</span> <span class=\"token keyword\">Sub</span></code></pre></div>\n<p>After it’s done executing, it proceeds to change the Boolean <code class=\"language-text\">DQdqmDHFAZsXlO/InitDone</code> to TRUE, then <code class=\"language-text\">KWcnPHwXPA/Base64Decode</code> resumes, and then calls function <code class=\"language-text\">jIuArLmtySP/ConvertStringToBytes</code>.</p>\n<p><strong><em><code class=\"language-text\">KWcnPHwXPA/Base64Decode</code></em> calls function <em><code class=\"language-text\">jIuArLmtySP/ConvertStringToBytes</code></em>:-</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> jIuArLmtySP<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> WyGwDJjQmpPM <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">Dim</span> WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> WAGoWUDaPZsf <span class=\"token operator\">=</span> WyGwDJjQmpPM\n<span class=\"token keyword\">Dim</span> ohnKHLnEngC <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> ohnKHLnEngC <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>UBound<span class=\"token punctuation\">(</span>WAGoWUDaPZsf<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> ohnKHLnEngC <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> jIuArLmtySP <span class=\"token operator\">=</span> WAGoWUDaPZsf<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Function</span>\n<span class=\"token keyword\">Dim</span> CdOASRvZYFf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">ReDim</span> CdOASRvZYFf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> ohnKHLnEngC <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n<span class=\"token keyword\">Dim</span> pulOTurWsADzsz <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n<span class=\"token keyword\">For</span> pulOTurWsADzsz <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">To</span> ohnKHLnEngC <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">Dim</span> OIMIqegisYd <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> OIMIqegisYd <span class=\"token operator\">=</span> WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> pulOTurWsADzsz<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">77</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">333</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">CLng</span><span class=\"token punctuation\">(</span>WAGoWUDaPZsf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> pulOTurWsADzsz <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">If</span> OIMIqegisYd <span class=\"token operator\">></span><span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">221</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span> <span class=\"token keyword\">Xor</span> <span class=\"token number\">19</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">Then</span> OIMIqegisYd <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span>\nCdOASRvZYFf<span class=\"token punctuation\">(</span>pulOTurWsADzsz<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> OIMIqegisYd\n<span class=\"token keyword\">Next</span>\njIuArLmtySP <span class=\"token operator\">=</span> CdOASRvZYFf\n<span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p><strong>Deobfuscated Function:- (vba-obfuscator/obfuscator/modifier/strings/base64.vbs)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"vb\"><pre class=\"language-vb\"><code class=\"language-vb\"><span class=\"token keyword\">Private</span> <span class=\"token keyword\">Function</span> ConvertStringToBytes<span class=\"token punctuation\">(</span><span class=\"token keyword\">ByVal</span> s <span class=\"token keyword\">As</span> <span class=\"token keyword\">String</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">Dim</span> b1<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span><span class=\"token punctuation\">:</span> b1 <span class=\"token operator\">=</span> s\n   <span class=\"token keyword\">Dim</span> l <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>UBound<span class=\"token punctuation\">(</span>b1<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">\\</span> <span class=\"token number\">2</span>\n   <span class=\"token keyword\">If</span> l <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">Then</span> ConvertStringToBytes <span class=\"token operator\">=</span> b1<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Exit</span> <span class=\"token keyword\">Function</span>\n   <span class=\"token keyword\">Dim</span> b2<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n   <span class=\"token keyword\">ReDim</span> b2<span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token keyword\">To</span> l <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">As</span> <span class=\"token keyword\">Byte</span>\n   <span class=\"token keyword\">Dim</span> p <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span>\n   <span class=\"token keyword\">For</span> p <span class=\"token operator\">=</span> <span class=\"token number\">0</span> <span class=\"token keyword\">To</span> l <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n      <span class=\"token keyword\">Dim</span> c <span class=\"token keyword\">As</span> <span class=\"token keyword\">Long</span><span class=\"token punctuation\">:</span> c <span class=\"token operator\">=</span> b1<span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> p<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">256</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">CLng</span><span class=\"token punctuation\">(</span>b1<span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> p <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">If</span> c <span class=\"token operator\">></span><span class=\"token operator\">=</span> <span class=\"token number\">256</span> <span class=\"token keyword\">Then</span> c <span class=\"token operator\">=</span> Asc<span class=\"token punctuation\">(</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span>\n      b2<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> c\n      <span class=\"token keyword\">Next</span>\n   ConvertStringToBytes <span class=\"token operator\">=</span> b2\n   <span class=\"token keyword\">End</span> <span class=\"token keyword\">Function</span></code></pre></div>\n<p>Coming back to <code class=\"language-text\">hhWpOZVspDmEP/unxor</code> function.</p>\n<p>It stores all the data into a variable called <code class=\"language-text\">PwFVZbOlxLL/key</code> and then deobfuscates the code into a variable called <code class=\"language-text\">nMFesEttTo/cleartext</code> and then <code class=\"language-text\">hhWpOZVspDmEP/unxor</code> is set equal to <code class=\"language-text\">nMFesEttTo/cleartext</code>.</p>\n<p>The unxor function will be called twice because the string gets divided into two parts and the deobfuscation is run twice with the <code class=\"language-text\">PwFVZbOlxLL/key</code>.</p>\n<p>After all of this has happened, the MsgBox is ran, and we get <strong><code class=\"language-text\">“Hello World”</code></strong>!</p>\n<hr>\n<p>In my opinion, this is a very interesting way of obfuscating a macro script. While nbonnet wrote the white paper for this in French, I was still able to figure out a lot of stuff by manual analysis. In the future, I will go into detail what all the functions do!</p>\n<p>Tho this fascinating piece of tool has it’s advantages, I still yet have to see it in a Phishing Campaign to say the least. Waiting for Threat Actors to find this xD</p>\n<p>Anyways this was SYN, and soon enough there will be a part 2 to this(?).\nGoodbye!</p>","excerpt":"Hello there! How are you doing this fine day? Welcome to my blog post about a fascinating tool which can make your computer’s life hell if…"}},"pageContext":{"type":"posts","next":null,"previous":null}}}